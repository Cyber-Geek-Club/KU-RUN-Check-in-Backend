# ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (Event Holidays)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏±‡∏ô ‡πÄ‡∏ä‡πà‡∏ô:
- ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° 30 ‡∏ß‡∏±‡∏ô ‡πÅ‡∏ï‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå
- ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°-‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏° ‡πÅ‡∏ï‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå
- ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ ‡πÅ‡∏ï‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå

## üóÇÔ∏è ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

1. **Model**: `src/models/event_holiday.py`
2. **CRUD**: `src/crud/event_holiday_crud.py`
3. **Schema**: `src/schemas/event_holiday_schema.py`
4. **Endpoints**: `src/api/endpoints/event_holidays.py`
5. **Migration**: `src/migrate/migrate_event_holidays.py`

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. ‡∏£‡∏±‡∏ô Migration

```bash
python src/migrate/migrate_event_holidays.py
```

### 2. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î

#### ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏•‡∏∞‡∏ß‡∏±‡∏ô
```bash
POST /api/events/{event_id}/holidays
```
```json
{
  "holiday_date": "2026-01-15",
  "holiday_name": "‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏π",
  "description": "‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå"
}
```

#### ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
```bash
POST /api/events/{event_id}/holidays/bulk
```
```json
{
  "holidays": [
    {
      "holiday_date": "2026-01-15",
      "holiday_name": "‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏π"
    },
    {
      "holiday_date": "2026-04-13",
      "holiday_name": "‡∏ß‡∏±‡∏ô‡∏™‡∏á‡∏Å‡∏£‡∏≤‡∏ô‡∏ï‡πå"
    }
  ]
}
```

#### ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢ (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà)
```bash
POST /api/events/{event_id}/holidays/quick
```
```json
{
  "holiday_dates": [
    "2026-01-17",
    "2026-01-18",
    "2026-01-24",
    "2026-01-25"
  ],
  "holiday_names": [
    "‡πÄ‡∏™‡∏≤‡∏£‡πå",
    "‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå",
    "‡πÄ‡∏™‡∏≤‡∏£‡πå",
    "‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå"
  ]
}
```

### 3. ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î

```bash
GET /api/events/{event_id}/holidays
GET /api/events/{event_id}/holidays?include_past=false
```

### 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

```bash
GET /api/events/{event_id}/holidays/check/2026-01-15
```

Response:
```json
{
  "event_id": 1,
  "date": "2026-01-15",
  "is_holiday": true,
  "holiday_name": "‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏π",
  "description": "‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå"
}
```

### 5. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î

```bash
PATCH /api/events/{event_id}/holidays/{holiday_id}
```
```json
{
  "holiday_name": "‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏π (‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó)",
  "description": "‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà"
}
```

### 6. ‡∏•‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î

```bash
# ‡∏•‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡∏ß‡∏±‡∏ô
DELETE /api/events/{event_id}/holidays/{holiday_id}

# ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
DELETE /api/events/{event_id}/holidays
```

## üîß ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Helper

### ‡πÉ‡∏ô event_crud.py

```python
# ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î)
working_days = await event_crud.get_event_working_days(db, event_id)

# ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£
count = await event_crud.count_event_working_days(db, event_id)

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
is_holiday = await event_crud.is_event_day_holiday(db, event_id, date(2026, 1, 15))
```

### ‡πÉ‡∏ô Event Model

```python
event = await event_crud.get_event_by_id(db, event_id)

# ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
total = event.total_days

# ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î
holidays = event.holiday_count

# ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£
working = event.working_days_count
```

## üìä ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

```sql
CREATE TABLE event_holidays (
    id SERIAL PRIMARY KEY,
    event_id INTEGER NOT NULL REFERENCES events(id) ON DELETE CASCADE,
    holiday_date DATE NOT NULL,
    holiday_name VARCHAR(255),
    description TEXT,
    created_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    UNIQUE(event_id, holiday_date)
);
```

## üîí ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

- **‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö**: Staff, Organizer
- **‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£/‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö**: ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà login

## üí° ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° 30 ‡∏ß‡∏±‡∏ô ‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå

```python
# 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
event = await event_crud.create_event(db, event_data)

# 2. ‡∏´‡∏≤‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á
from datetime import date, timedelta

start = date(2026, 2, 1)
end = date(2026, 2, 28)
weekends = []

current = start
while current <= end:
    if current.weekday() in [5, 6]:  # Saturday = 5, Sunday = 6
        weekends.append(current)
    current += timedelta(days=1)

# 3. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
await event_holiday_crud.bulk_create_holidays(
    db, 
    event.id, 
    weekends,
    ["‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏™‡∏∏‡∏î‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå"] * len(weekends)
)
```

## ‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î

1. ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏Å‡∏±‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (`event_type = "multi_day"`)
2. ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á `event_date` ‡∏ñ‡∏∂‡∏á `event_end_date`
3. ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (unique constraint)

## üéØ Use Cases

1. **‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ß‡∏¥‡πà‡∏á‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô**: ‡∏ß‡∏¥‡πà‡∏á‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÅ‡∏ï‡πà‡∏´‡∏¢‡∏∏‡∏î‡∏ß‡∏±‡∏ô‡πÄ‡∏™‡∏≤‡∏£‡πå-‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå
2. **‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ï‡∏•‡∏≠‡∏î‡∏õ‡∏µ**: ‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå
3. **‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏±‡πâ‡∏ô**: ‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° 10 ‡∏ß‡∏±‡∏ô ‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 5 ‡∏´‡∏¢‡∏∏‡∏î
